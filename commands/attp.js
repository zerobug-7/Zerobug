const _0x235418=_0x1f45;(function(_0x49a5bb,_0x1f361f){const _0x566d0f=_0x1f45,_0x42ec91=_0x49a5bb();while(!![]){try{const _0x58838c=parseInt(_0x566d0f(0xdf))/0x1*(-parseInt(_0x566d0f(0xd8))/0x2)+parseInt(_0x566d0f(0xdb))/0x3*(parseInt(_0x566d0f(0xb8))/0x4)+parseInt(_0x566d0f(0xc8))/0x5*(-parseInt(_0x566d0f(0xe6))/0x6)+parseInt(_0x566d0f(0xb6))/0x7+-parseInt(_0x566d0f(0xb2))/0x8+parseInt(_0x566d0f(0xe1))/0x9*(-parseInt(_0x566d0f(0xde))/0xa)+-parseInt(_0x566d0f(0xd7))/0xb*(-parseInt(_0x566d0f(0xba))/0xc);if(_0x58838c===_0x1f361f)break;else _0x42ec91['push'](_0x42ec91['shift']());}catch(_0x856280){_0x42ec91['push'](_0x42ec91['shift']());}}}(_0x22ae,0x64670));const {spawn}=require('child_process'),fs=require('fs'),path=require(_0x235418(0xd5)),{writeExifImg,writeExifVid}=require(_0x235418(0xbf));function _0x1f45(_0xeb37c8,_0x21dfab){const _0x22ae45=_0x22ae();return _0x1f45=function(_0x1f45de,_0x4e1b83){_0x1f45de=_0x1f45de-0xb2;let _0x40346f=_0x22ae45[_0x1f45de];return _0x40346f;},_0x1f45(_0xeb37c8,_0x21dfab);}async function attpCommand(_0x44084b,_0x323fe5,_0x266ed1){const _0x2b623d=_0x235418,_0x5cfeb1=_0x266ed1[_0x2b623d(0xbe)][_0x2b623d(0xbb)]||_0x266ed1['message']['extendedTextMessage']?.['text']||'',_0x479c39=_0x5cfeb1[_0x2b623d(0xc0)]('\x20')[_0x2b623d(0xcc)](0x1)['join']('\x20');if(!_0x479c39){await _0x44084b[_0x2b623d(0xe3)](_0x323fe5,{'text':_0x2b623d(0xb3)},{'quoted':_0x266ed1});return;}try{const _0x32b506=await renderBlinkingVideoWithFfmpeg(_0x479c39),_0x171cd2=await writeExifVid(_0x32b506,{'packname':'Knight\x20Bot'}),_0xf6ab47=fs[_0x2b623d(0xc9)](_0x171cd2);try{fs[_0x2b623d(0xb4)](_0x171cd2);}catch(_0x165d5c){}await _0x44084b[_0x2b623d(0xe3)](_0x323fe5,{'sticker':_0xf6ab47},{'quoted':_0x266ed1});}catch(_0x18e42e){console[_0x2b623d(0xe0)]('Error\x20generating\x20local\x20sticker:',_0x18e42e),await _0x44084b[_0x2b623d(0xe3)](_0x323fe5,{'text':'Failed\x20to\x20generate\x20the\x20sticker\x20locally.'},{'quoted':_0x266ed1});}}function _0x22ae(){const _0x225bab=['-movflags','sendMessage','close','lavfi','90786TNWJUl',':r=20','/usr/share/fonts/truetype/dejavu/DejaVuSans-Bold.ttf','1395232HcnCVA','Please\x20provide\x20text\x20after\x20the\x20.attp\x20command.','unlinkSync','\x27:text=\x27','1263318wHKjMG','mp4','863840EJKnDz','color=c=#00000000:s=512x512','12tljgZM','conversation','image2','pipe:1','message','../lib/exif','split','replace','ffmpeg\x20exited\x20with\x20code\x20','stderr','+faststart+frag_keyframe+empty_moov','),0.2)\x27','C:/Windows/Fonts/arialbd.ttf','stdout','145VbBOAj','readFileSync','ffmpeg','),0.1,0.2)\x27','slice','concat','push','platform','-vf','win32','\x27:fontcolor=white:fontsize=56:borderw=2:bordercolor=black@0.6:x=(w-text_w)/2:y=(h-text_h)/2','toString','exports','path','\x27:fontcolor=red:borderw=2:bordercolor=black@0.6:fontsize=56:x=(w-text_w)/2:y=(h-text_h)/2:enable=\x27lt(mod(t,','11599093jKzAHE','2bTomVa','\x27:fontcolor=blue:borderw=2:bordercolor=black@0.6:fontsize=56:x=(w-text_w)/2:y=(h-text_h)/2:enable=\x27between(mod(t,','drawtext=fontfile=\x27','6AqUmIs','data','color=c=black:s=512x512:d=','1269290QrSpAO','515477BXFqlf','error','9mrggBN'];_0x22ae=function(){return _0x225bab;};return _0x22ae();}module[_0x235418(0xd4)]=attpCommand;function renderTextToPngWithFfmpeg(_0xfc1c8a){return new Promise((_0x18766e,_0x5e3c9b)=>{const _0x4d20c9=_0x1f45,_0x2be912=process[_0x4d20c9(0xcf)]==='win32'?'C:/Windows/Fonts/arialbd.ttf':_0x4d20c9(0xe8),_0x546160=_0x176600=>_0x176600[_0x4d20c9(0xc1)](/\\/g,'\x5c\x5c')[_0x4d20c9(0xc1)](/:/g,'\x5c:')[_0x4d20c9(0xc1)](/'/g,'\x5c\x27')['replace'](/\[/g,'\x5c[')[_0x4d20c9(0xc1)](/\]/g,'\x5c]')[_0x4d20c9(0xc1)](/%/g,'\x5c%'),_0x367568=_0x546160(_0xfc1c8a),_0x11003e=process[_0x4d20c9(0xcf)]===_0x4d20c9(0xd1)?_0x2be912['replace'](/\\/g,'/')['replace'](':','\x5c:'):_0x2be912,_0x46eaac=['-y','-f','lavfi','-i',_0x4d20c9(0xb9),_0x4d20c9(0xd0),_0x4d20c9(0xda)+_0x11003e+_0x4d20c9(0xb5)+_0x367568+_0x4d20c9(0xd2),'-frames:v','1','-f',_0x4d20c9(0xbc),_0x4d20c9(0xbd)],_0x789507=spawn(_0x4d20c9(0xca),_0x46eaac),_0x4f571a=[],_0x557d48=[];_0x789507[_0x4d20c9(0xc7)]['on'](_0x4d20c9(0xdc),_0x2c8000=>_0x4f571a[_0x4d20c9(0xce)](_0x2c8000)),_0x789507[_0x4d20c9(0xc3)]['on'](_0x4d20c9(0xdc),_0x1c0a38=>_0x557d48['push'](_0x1c0a38)),_0x789507['on'](_0x4d20c9(0xe0),_0x5e3c9b),_0x789507['on'](_0x4d20c9(0xe4),_0x509d51=>{const _0x57c4aa=_0x4d20c9;if(_0x509d51===0x0)return _0x18766e(Buffer['concat'](_0x4f571a));_0x5e3c9b(new Error(Buffer[_0x57c4aa(0xcd)](_0x557d48)[_0x57c4aa(0xd3)]()||_0x57c4aa(0xc2)+_0x509d51));});});}function renderBlinkingVideoWithFfmpeg(_0x36548a){return new Promise((_0x3e2ec5,_0x3400ee)=>{const _0x80fecf=_0x1f45,_0x317416=process['platform']===_0x80fecf(0xd1)?_0x80fecf(0xc6):_0x80fecf(0xe8),_0x198190=_0x4263c5=>_0x4263c5[_0x80fecf(0xc1)](/\\/g,'\x5c\x5c')[_0x80fecf(0xc1)](/:/g,'\x5c:')['replace'](/,/g,'\x5c,')[_0x80fecf(0xc1)](/'/g,'\x5c\x27')['replace'](/\[/g,'\x5c[')['replace'](/\]/g,'\x5c]')[_0x80fecf(0xc1)](/%/g,'\x5c%'),_0x22a6f1=_0x198190(_0x36548a),_0x55ae31=process[_0x80fecf(0xcf)]===_0x80fecf(0xd1)?_0x317416[_0x80fecf(0xc1)](/\\/g,'/')['replace'](':','\x5c:'):_0x317416,_0x34371a=0.3,_0x2b624f=1.8,_0x52458=_0x80fecf(0xda)+_0x55ae31+_0x80fecf(0xb5)+_0x22a6f1+_0x80fecf(0xd6)+_0x34371a+'),0.1)\x27',_0x256e90=_0x80fecf(0xda)+_0x55ae31+_0x80fecf(0xb5)+_0x22a6f1+_0x80fecf(0xd9)+_0x34371a+_0x80fecf(0xcb),_0x4b4ad0=_0x80fecf(0xda)+_0x55ae31+_0x80fecf(0xb5)+_0x22a6f1+'\x27:fontcolor=green:borderw=2:bordercolor=black@0.6:fontsize=56:x=(w-text_w)/2:y=(h-text_h)/2:enable=\x27gte(mod(t,'+_0x34371a+_0x80fecf(0xc5),_0x92b788=_0x52458+','+_0x256e90+','+_0x4b4ad0,_0x3b2996=['-y','-f',_0x80fecf(0xe5),'-i',_0x80fecf(0xdd)+_0x2b624f+_0x80fecf(0xe7),'-vf',_0x92b788,'-c:v','libx264','-pix_fmt','yuv420p',_0x80fecf(0xe2),_0x80fecf(0xc4),'-t',String(_0x2b624f),'-f',_0x80fecf(0xb7),_0x80fecf(0xbd)],_0x38e537=spawn('ffmpeg',_0x3b2996),_0x14f1cb=[],_0xf936df=[];_0x38e537[_0x80fecf(0xc7)]['on'](_0x80fecf(0xdc),_0x21543f=>_0x14f1cb[_0x80fecf(0xce)](_0x21543f)),_0x38e537[_0x80fecf(0xc3)]['on'](_0x80fecf(0xdc),_0x41c56e=>_0xf936df['push'](_0x41c56e)),_0x38e537['on'](_0x80fecf(0xe0),_0x3400ee),_0x38e537['on'](_0x80fecf(0xe4),_0x22f685=>{const _0x28b1ad=_0x80fecf;if(_0x22f685===0x0)return _0x3e2ec5(Buffer[_0x28b1ad(0xcd)](_0x14f1cb));_0x3400ee(new Error(Buffer['concat'](_0xf936df)[_0x28b1ad(0xd3)]()||_0x28b1ad(0xc2)+_0x22f685));});});}